window.onload=function(){function a(){const l=mocha.run().on('test end',m=>b(m)).on('end',()=>{if(___browserSync___){l.total!==h&&(l.total?console.warn(`${l.total} out of ${h} tests ran.`):console.warn('Make sure the LearnBrowser JS file is loaded *after* the test suite in index.html.')),c(l);const m=d(j);e(m)}else console.warn('In order to push test data to Learn\'s servers, you must start the test suite from your terminal with the \'learn\' or \'npm test\' command.')})}function b(l){const m=f(l);k.tests.push(m),l.pending?k.pending.push(m):'passed'===l.state?k.passes.push(m):'failed'===l.state&&k.failures.push(m)}function c(l){j.examples=h,j.passing_count=l.stats.passes,j.failure_count=l.stats.failures,j.pending_count=l.stats.pending,k.stats=l.stats,j.build.test_suite[0].duration=l.stats}function d(l){const m=___browserSync___.socketConfig,n={username:m.username,github_user_id:m.github_user_id,learn_oauth_token:m.learn_oauth,repo_name:m.repo_name,ruby_platform:m.ruby_platform,ide_container:m.ide_container};return Object.assign({},n,l)}function e(l){fetch('http://ironbroker-v2.flatironschool.com/e/flatiron_mocha',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(l),mode:'no-cors'}).then(()=>{}).catch(()=>console.warn('Unable to contact Learn servers. Please check your Internet connection and try again.'))}function f(l){return{title:l.title,fullTitle:g(l),duration:l.duration,currentRetry:l._currentRetry,err:l.err}}function g(l){let m=l.title,n=l.parent;for(;n&&'Suite'===n.constructor.name;)m=n.title.concat(' ',m),n=n.parent;return m}let h=0;const i=l=>{for(const m of l)m.tests&&(h+=m.tests.length),m.suites&&m.suites.length&&i(m.suites)};i(mocha.suite.suites);const j={build:{test_suite:[{framework:'mocha',formatted_output:{tests:[],pending:[],failures:[],passes:[]}}]}},{formatted_output:k}=j.build.test_suite[0];return()=>a()}();
