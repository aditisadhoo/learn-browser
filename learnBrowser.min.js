window.onload=function(){const f=(r,t)=>{for(const u of r.suites)t=f(u,t);return t+=r.tests.length},g=f(mocha.suite,0),h={build:{test_suite:[{framework:'mocha',formatted_output:{tests:[],pending:[],failures:[],passes:[]}}]}},{formatted_output:i}=h.build.test_suite[0],j=r=>{const t=r.run().on('test end',u=>l(p(u))).on('end',()=>k(t))},k=r=>{if(___browserSync___===void 0)console.warn('In order to push test data to Learn\'s servers, you must start the test suite from your terminal with the \'learn\' or \'npm test\' command.');else if(0===r.total)console.warn('Make sure the LearnBrowser JS file is loaded *after* the test suite in index.html.');else if(r.total!==g)console.warn(`${r.total} out of ${g} tests ran.`);else{m(r);const t=n(h,___browserSync___.socketConfig);o(t)}},l=r=>{switch(i.tests.push(r),!0){case'failed'===r.state:i.failures.push(r);break;case'passed'===r.state:i.passes.push(r);break;case r.pending:i.pending.push(r);}},m=({stats:r})=>{h.examples=g,h.passing_count=r.passes,h.failure_count=r.failures,h.pending_count=r.pending,i.stats=r,h.build.test_suite[0].duration=r},n=(r,{username:t,github_user_id:u,learn_oauth_token:v,repo_name:w,ruby_platform:x,ide_container:y})=>Object.assign({},r,{username:t,github_user_id:u,learn_oauth_token:v,repo_name:w,ruby_platform:x,ide_container:y}),o=r=>fetch('http://ironbroker-v2.flatironschool.com/e/flatiron_mocha',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(r),mode:'no-cors'}).then(()=>{}).catch(()=>console.warn('Unable to contact Learn servers. Please check your Internet connection and try again.')),p=({title:r,parent:t,duration:u,_currentRetry:v,err:w})=>({title:r,fullTitle:q(r,t),duration:u,currentRetry:v,err:w}),q=(r,t)=>{for(;t&&'Suite'===t.constructor.name;)r=t.title.concat(' ',r),t=t.parent;return r.trim()};return()=>j(mocha)}();
