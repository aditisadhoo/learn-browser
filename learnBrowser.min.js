window.onload=function(){function a(){const m=mocha.run().on('test end',n=>b(n)).on('end',()=>{if(___browserSync___){m.total!==h&&(m.total?console.warn(`${m.total} out of ${h} tests ran.`):console.warn('Make sure the LearnBrowser JS file is loaded *after* the test suite in index.html.')),c(m);const n=d(k);e(n)}else console.warn('In order to push test data to Learn\'s servers, you must start the test suite from your terminal with the \'learn\' or \'npm test\' command.')})}function b(m){const n=f(m);l.tests.push(n),m.pending?l.pending.push(n):'passed'===m.state?l.passes.push(n):'failed'===m.state&&l.failures.push(n)}function c(m){k.examples=h,k.passing_count=m.stats.passes,k.failure_count=m.stats.failures,k.pending_count=m.stats.pending,l.stats=m.stats,k.build.test_suite[0].duration=m.stats}function d(m){const n=___browserSync___.socketConfig,o={username:n.username,github_user_id:n.github_user_id,learn_oauth_token:n.learn_oauth,repo_name:n.repo_name,ruby_platform:n.ruby_platform,ide_container:n.ide_container};return Object.assign({},o,m)}function e(m){fetch('http://ironbroker-v2.flatironschool.com/e/flatiron_mocha',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(m),mode:'no-cors'}).then(()=>{}).catch(()=>console.warn('Unable to contact Learn servers. Please check your Internet connection and try again.'))}function f(m){return{title:m.title,fullTitle:g(m),duration:m.duration,currentRetry:m._currentRetry,err:m.err}}function g(m){let n=m.title,o=m.parent;for(;o&&'Suite'===o.constructor.name;)n=o.title.concat(' ',n),o=o.parent;return n}let h=0;const j=m=>{for(let n=0;n<m.length;n++)m[n].suites.length?j(m[n].suites):h+=m[n].tests.length};j(mocha.suite.suites);const k={build:{test_suite:[{framework:'mocha',formatted_output:{tests:[],pending:[],failures:[],passes:[]}}]}},l=k.build.test_suite[0].formatted_output;return()=>a()}();
